<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>eRestaurant - Reporting Basics | DMIT-2018 Student Notes</title>
    <meta name="description" content="Intermediate Application Development">
    
    
    <link rel="preload" href="/assets/css/0.styles.912ec5d4.css" as="style"><link rel="preload" href="/assets/js/app.8a77dee6.js" as="script"><link rel="preload" href="/assets/js/35.41f51767.js" as="script"><link rel="prefetch" href="/assets/js/1.693ea067.js"><link rel="prefetch" href="/assets/js/2.2751e7ce.js"><link rel="prefetch" href="/assets/js/3.40b5b4b9.js"><link rel="prefetch" href="/assets/js/4.6bd12850.js"><link rel="prefetch" href="/assets/js/5.6bca6039.js"><link rel="prefetch" href="/assets/js/6.bea529c2.js"><link rel="prefetch" href="/assets/js/7.32db9b82.js"><link rel="prefetch" href="/assets/js/8.31cbe999.js"><link rel="prefetch" href="/assets/js/9.7b97de5d.js"><link rel="prefetch" href="/assets/js/10.92758e3a.js"><link rel="prefetch" href="/assets/js/11.38d189fd.js"><link rel="prefetch" href="/assets/js/12.308d89ec.js"><link rel="prefetch" href="/assets/js/13.5b6f6628.js"><link rel="prefetch" href="/assets/js/14.4c0d7dd2.js"><link rel="prefetch" href="/assets/js/15.2221b8ac.js"><link rel="prefetch" href="/assets/js/16.14006d57.js"><link rel="prefetch" href="/assets/js/17.72f794a0.js"><link rel="prefetch" href="/assets/js/18.83cb5670.js"><link rel="prefetch" href="/assets/js/19.11c8217b.js"><link rel="prefetch" href="/assets/js/20.46c3aee9.js"><link rel="prefetch" href="/assets/js/21.821a878f.js"><link rel="prefetch" href="/assets/js/22.d332d5da.js"><link rel="prefetch" href="/assets/js/23.63317f90.js"><link rel="prefetch" href="/assets/js/24.8650b50a.js"><link rel="prefetch" href="/assets/js/25.cd009a1b.js"><link rel="prefetch" href="/assets/js/26.7c0e9e66.js"><link rel="prefetch" href="/assets/js/27.93fdb398.js"><link rel="prefetch" href="/assets/js/28.5b8745a2.js"><link rel="prefetch" href="/assets/js/29.bae8b44a.js"><link rel="prefetch" href="/assets/js/30.9eaa79ef.js"><link rel="prefetch" href="/assets/js/31.39f83913.js"><link rel="prefetch" href="/assets/js/32.df57bb51.js"><link rel="prefetch" href="/assets/js/33.f38713cb.js"><link rel="prefetch" href="/assets/js/34.ff8c2ca8.js"><link rel="prefetch" href="/assets/js/36.344d16f0.js"><link rel="prefetch" href="/assets/js/37.a982c285.js"><link rel="prefetch" href="/assets/js/38.2ac52da2.js"><link rel="prefetch" href="/assets/js/39.ca2304da.js"><link rel="prefetch" href="/assets/js/40.5c858498.js"><link rel="prefetch" href="/assets/js/41.a9720681.js"><link rel="prefetch" href="/assets/js/42.d828affe.js"><link rel="prefetch" href="/assets/js/43.fe70e5d5.js"><link rel="prefetch" href="/assets/js/44.647062f2.js"><link rel="prefetch" href="/assets/js/45.2ffd4719.js"><link rel="prefetch" href="/assets/js/46.f4f73417.js"><link rel="prefetch" href="/assets/js/47.1283ea97.js"><link rel="prefetch" href="/assets/js/48.7631289c.js"><link rel="prefetch" href="/assets/js/49.79236172.js"><link rel="prefetch" href="/assets/js/50.e26f3abc.js"><link rel="prefetch" href="/assets/js/51.10abb04d.js"><link rel="prefetch" href="/assets/js/52.c1d244d8.js"><link rel="prefetch" href="/assets/js/53.3078574c.js"><link rel="prefetch" href="/assets/js/54.2c66d0e0.js"><link rel="prefetch" href="/assets/js/55.7e5fe0e8.js"><link rel="prefetch" href="/assets/js/56.80928a9d.js"><link rel="prefetch" href="/assets/js/57.3e3ed549.js"><link rel="prefetch" href="/assets/js/58.15960703.js"><link rel="prefetch" href="/assets/js/59.23fefda5.js"><link rel="prefetch" href="/assets/js/60.6c0c9fdd.js"><link rel="prefetch" href="/assets/js/61.3fb94322.js"><link rel="prefetch" href="/assets/js/62.7a402234.js"><link rel="prefetch" href="/assets/js/63.ede90de9.js"><link rel="prefetch" href="/assets/js/64.9fb2d2d7.js"><link rel="prefetch" href="/assets/js/65.02471039.js"><link rel="prefetch" href="/assets/js/66.8ac0a19f.js"><link rel="prefetch" href="/assets/js/67.879297d8.js"><link rel="prefetch" href="/assets/js/68.88cc29c3.js"><link rel="prefetch" href="/assets/js/69.abdde1f0.js"><link rel="prefetch" href="/assets/js/70.b96196f8.js"><link rel="prefetch" href="/assets/js/71.feef6795.js"><link rel="prefetch" href="/assets/js/72.692c2970.js"><link rel="prefetch" href="/assets/js/73.b9549a1f.js"><link rel="prefetch" href="/assets/js/74.54956d5b.js"><link rel="prefetch" href="/assets/js/75.344b84b9.js"><link rel="prefetch" href="/assets/js/76.f3df92c7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.912ec5d4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DMIT-2018 Student Notes</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/topics/" class="nav-link">Notes</a></div><div class="nav-item"><a href="/demos/" class="nav-link router-link-active">Demos</a></div><div class="nav-item"><a href="/about/slides-installing-sql-server.html" class="nav-link">MS SQL 2017</a></div><div class="nav-item"><a href="/exercises/" class="nav-link">Take Home</a></div><div class="nav-item"><a href="https://github.com/DMIT-2018/StudentNotes/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Issues/Bugs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://moodle.nait.ca" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Moodle
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/topics/" class="nav-link">Notes</a></div><div class="nav-item"><a href="/demos/" class="nav-link router-link-active">Demos</a></div><div class="nav-item"><a href="/about/slides-installing-sql-server.html" class="nav-link">MS SQL 2017</a></div><div class="nav-item"><a href="/exercises/" class="nav-link">Take Home</a></div><div class="nav-item"><a href="https://github.com/DMIT-2018/StudentNotes/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Issues/Bugs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://moodle.nait.ca" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Moodle
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/demos/" class="sidebar-link">Demos</a></li><li><a href="/demos/eRestaurant/" class="sidebar-link">eRestaurant Demo</a></li><li><a href="/demos/Northwind/" class="sidebar-link">Northwind Traders Demo</a></li><li><a href="/demos/Chinook/" class="sidebar-link">Chinook Demo</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="erestaurant-reporting-basics"><a href="#erestaurant-reporting-basics" aria-hidden="true" class="header-anchor">#</a> eRestaurant - Reporting Basics</h1> <p>You can add reports to your ASP.NET website using Microsoft's Report and ReportViewer. The data for a report can be supplied by any collection that supports iEnumerable, such as a List of Custom Business Objects (<code>List&lt;T&gt;</code>), a Typed DataSet, or a LINQ query.</p> <p>The following steps demonstrate how to create a simple report based on a collection created by a Linq query within your Business Logic Layer (BLL) controller. The collection is defined by a POCO class called CategoryMenuItem. The data within this class is considered a flat data collection.</p> <h2 id="building-the-backend"><a href="#building-the-backend" aria-hidden="true" class="header-anchor">#</a> Building the BackEnd</h2> <h3 id="create-the-poco-collection-class"><a href="#create-the-poco-collection-class" aria-hidden="true" class="header-anchor">#</a> Create the POCO collection class</h3> <p>Add a new class to your POCOs folder called CategoryMenuItem.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">namespace</span> eRestaurantSystem<span class="token punctuation">.</span>POCOs
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CategoryMenuItems</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> CategoryDescription <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> ItemDescription <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">decimal</span> Price <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">int</span><span class="token operator">?</span> Calories <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token keyword">string</span> Comment <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="create-the-bll-method"><a href="#create-the-bll-method" aria-hidden="true" class="header-anchor">#</a> Create the BLL method</h3> <p>Create a new DataObjectMethod called GetReportCategoryMenuItems() within your BLL controller class. This method will select from the Items DbSet and use the POCO class CategoryMenuItem. Preordering of the data can be done at this time or deferred to when the report runs. Since the Linq command is eventually run within SQL, why not use the optimization power of the database management system to sort the data. Notice the use of POCOs when qualifying the datatype on select new. This is required because there is also a DTO class by the same name. Remember to place a Using statement with the rest of your namespaces.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">DataObjectMethod</span><span class="token punctuation">(</span>DataObjectMethodType<span class="token punctuation">.</span>Select<span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> List<span class="token operator">&lt;</span>POCOs<span class="token punctuation">.</span>CategoryMenuItems<span class="token operator">&gt;</span> <span class="token function">GetReportCategoryMenuItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">using</span> <span class="token punctuation">(</span>eRestaurantContext context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">eRestaurantContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">var</span> results <span class="token operator">=</span> <span class="token keyword">from</span> cat <span class="token keyword">in</span> context<span class="token punctuation">.</span><span class="token class-name">Items</span>
                        <span class="token keyword">orderby</span> cat<span class="token punctuation">.</span>MenuCategory<span class="token punctuation">.</span>Description<span class="token punctuation">,</span> cat<span class="token punctuation">.</span><span class="token class-name">Description</span>
                        <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token class-name">POCOs<span class="token punctuation">.</span>CategoryMenuItems</span>
                        <span class="token punctuation">{</span>
                            CategoryDescription <span class="token operator">=</span> cat<span class="token punctuation">.</span>MenuCategory<span class="token punctuation">.</span>Description<span class="token punctuation">,</span>
                            ItemDescription <span class="token operator">=</span> cat<span class="token punctuation">.</span>Description<span class="token punctuation">,</span>
                            Price <span class="token operator">=</span> cat<span class="token punctuation">.</span>CurrentPrice<span class="token punctuation">,</span>
                            Calories <span class="token operator">=</span> cat<span class="token punctuation">.</span>Calories<span class="token punctuation">,</span>
                            Comment <span class="token operator">=</span> cat<span class="token punctuation">.</span>Comment
                        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> results<span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// this was .Dump() in Linqpad</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="create-the-report"><a href="#create-the-report" aria-hidden="true" class="header-anchor">#</a> Create the Report</h2> <p>Create a new folder under the web site called Reports. All the report .rdlc files will be placed here. These files are an XML representation of the report definition.</p> <h3 id="select-report-details-and-grouping"><a href="#select-report-details-and-grouping" aria-hidden="true" class="header-anchor">#</a> Select Report Details and Grouping</h3> <ol><li>Right-click on your website (or a folder of your website) and select &quot;Add New Item…&quot;. Select the Report Wizard template and give it the name &quot;CategoryMenuItems.rdlc&quot;. This will bring up the report wizard.</li></ol> <p><img src="/assets/img/Wizard_01.b11a3dcb.jpg" alt="Add New Item - Report Wizard"></p> <ol start="2"><li>In the Dataset Propertied dialog, enter &quot;CategoryMenuItemDS&quot; as the Name. Select your BLL controller as the Data source. Select the GetReportCategoryMenuItems as the Available datasets. Then, click Next.</li></ol> <p><img src="/assets/img/Wizard_02.6dd76f55.jpg" alt="Report Wizard - Dataset Properties"></p> <ol start="3"><li>In the Arrange fields, click on the item in Available Fields and drag it to either Row groups or Values as shown in the image. Values will create the Detail line of your report. The detail lines will be grouped under the Row group. Numerics are automatically assumed to be Sum(). To remove this Sum(), click on the down arrow and uncheck the Sum. Click Next.</li></ol> <p><img src="/assets/img/Wizard_03.546a1312.jpg" alt="Report Wizard - Arrange fields"></p> <ol start="4"><li>In the Choose the layout, change from Blocked, subtotal below to Stepped, subtotal above. The Expand/collapse groups will allow for drill down of your display. Click Next.</li></ol> <p><img src="/assets/img/Wizard_04.854d3439.jpg" alt="Report Wizard - Choose the layout"></p> <ol start="5"><li>Choose one of the default styles and click Next.</li></ol> <p><img src="/assets/img/Wizard_05.0cc79d8a.jpg" alt="Report Wizard - Choose a style"></p> <ol start="6"><li>You now have your basic report with no customization or formatting. In your Solution you have a new entry which is the .rdlc file. This is the XML representation of the report definition. Open it and view the code but do not touch.</li></ol> <p><img src="/assets/img/Wizard_06.cf8279a6.jpg" alt="Report (.rdlc)"></p> <h3 id="create-the-webform-with-a-reportviewer"><a href="#create-the-webform-with-a-reportviewer" aria-hidden="true" class="header-anchor">#</a> Create the WebForm with a ReportViewer</h3> <ul><li>Add a new Web Form to your web site demonstration page folder naming it &quot;ReportCategoryMenuItems.aspx&quot;.
<ul><li>In our Visual Studio 2013 website template, the site.master will have the ScriptManager by default.</li> <li>You can check your site.master for a ScriptManager object. If you do not have this object on the .aspx page, drag a ScriptManager from the AJAX Extensions (or ToolscriptManager) control onto your form.</li></ul></li></ul> <p><img src="/assets/img/WebForm_01.71253d95.jpg" alt="Screenshot"></p> <ul><li>Next, drag and ObjectDataSource to your form, and give it the ID &quot;ODSCategoryMenuItems&quot;. The click the object data source's smart tag and select &quot;Configure Data Source…&quot;. Configure your data source to the GetReportCategoryMenuItems within the BLL controller.</li></ul> <p><img src="/assets/img/WebForm_02.7b421a57.jpg" alt="Screenshot"></p> <ul><li>From the Reporting set of tools in the Toolbox, drag a ReportViewer onto your form. Set its Width property to &quot;100%&quot;. Then, click the ReportViewer's smart tag and select &quot;CategoryMenutIems.rdlc&quot; in the Choose Report drop-down.</li></ul> <p><img src="/assets/img/WebForm_03.4397d86e.jpg" alt="Screenshot"></p> <ul><li>Click the ReportViewer's smart tag once more and click on Choose Data Sources. Select the &quot;ODSCategoryMenuItems&quot; as the Data Source Instance and click OK.</li></ul> <p><img src="/assets/img/Webform_04.6daafc83.jpg" alt="Screenshot"></p> <ul><li>Save the form, and then view it in the Browser. You should get a form that looks like the following.</li></ul> <p><img src="WebForm_05.jpg" alt="Screenshot"></p></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">7/4/2018, 4:01:50 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/35.41f51767.js" defer></script><script src="/assets/js/app.8a77dee6.js" defer></script>
  </body>
</html>
