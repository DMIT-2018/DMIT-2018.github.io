<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MessageUserControl | DMIT-2018 Student Notes</title>
    <meta name="description" content="Intermediate Application Development">
    
    
    <link rel="preload" href="/assets/css/0.styles.912ec5d4.css" as="style"><link rel="preload" href="/assets/js/app.e1abd37d.js" as="script"><link rel="preload" href="/assets/js/52.b73eca62.js" as="script"><link rel="prefetch" href="/assets/js/1.faad04a9.js"><link rel="prefetch" href="/assets/js/2.608da0e5.js"><link rel="prefetch" href="/assets/js/3.cfa9a397.js"><link rel="prefetch" href="/assets/js/4.f34c76ce.js"><link rel="prefetch" href="/assets/js/5.f6b79f2b.js"><link rel="prefetch" href="/assets/js/6.066b1e21.js"><link rel="prefetch" href="/assets/js/7.a431b6ee.js"><link rel="prefetch" href="/assets/js/8.eff39f68.js"><link rel="prefetch" href="/assets/js/9.14e30e10.js"><link rel="prefetch" href="/assets/js/10.59268026.js"><link rel="prefetch" href="/assets/js/11.79c932f4.js"><link rel="prefetch" href="/assets/js/12.16b37815.js"><link rel="prefetch" href="/assets/js/13.2c287836.js"><link rel="prefetch" href="/assets/js/14.d0b73412.js"><link rel="prefetch" href="/assets/js/15.8b2125e7.js"><link rel="prefetch" href="/assets/js/16.291f5f25.js"><link rel="prefetch" href="/assets/js/17.c251c0fe.js"><link rel="prefetch" href="/assets/js/18.445d800c.js"><link rel="prefetch" href="/assets/js/19.f0721460.js"><link rel="prefetch" href="/assets/js/20.1f7ee312.js"><link rel="prefetch" href="/assets/js/21.81304474.js"><link rel="prefetch" href="/assets/js/22.a6968279.js"><link rel="prefetch" href="/assets/js/23.464826dd.js"><link rel="prefetch" href="/assets/js/24.8073c91e.js"><link rel="prefetch" href="/assets/js/25.5f9cbfe6.js"><link rel="prefetch" href="/assets/js/26.278b8e38.js"><link rel="prefetch" href="/assets/js/27.cdfa265e.js"><link rel="prefetch" href="/assets/js/28.ca9bf041.js"><link rel="prefetch" href="/assets/js/29.5179a339.js"><link rel="prefetch" href="/assets/js/30.d840a6dd.js"><link rel="prefetch" href="/assets/js/31.f8ec275a.js"><link rel="prefetch" href="/assets/js/32.4ccfb390.js"><link rel="prefetch" href="/assets/js/33.cab34f45.js"><link rel="prefetch" href="/assets/js/34.76d3e6d3.js"><link rel="prefetch" href="/assets/js/35.2f69732e.js"><link rel="prefetch" href="/assets/js/36.4a1b194f.js"><link rel="prefetch" href="/assets/js/37.8907dd15.js"><link rel="prefetch" href="/assets/js/38.99af0c18.js"><link rel="prefetch" href="/assets/js/39.f650ec6d.js"><link rel="prefetch" href="/assets/js/40.938fe550.js"><link rel="prefetch" href="/assets/js/41.5701f4e5.js"><link rel="prefetch" href="/assets/js/42.bcd5cb9f.js"><link rel="prefetch" href="/assets/js/43.bd0563c9.js"><link rel="prefetch" href="/assets/js/44.d2ada1d2.js"><link rel="prefetch" href="/assets/js/45.62e97aef.js"><link rel="prefetch" href="/assets/js/46.a284af4c.js"><link rel="prefetch" href="/assets/js/47.465dd182.js"><link rel="prefetch" href="/assets/js/48.05459ab9.js"><link rel="prefetch" href="/assets/js/49.10864aff.js"><link rel="prefetch" href="/assets/js/50.29c2a083.js"><link rel="prefetch" href="/assets/js/51.dfb1627a.js"><link rel="prefetch" href="/assets/js/53.06e9c069.js"><link rel="prefetch" href="/assets/js/54.547f9c2a.js"><link rel="prefetch" href="/assets/js/55.76d4a7ce.js"><link rel="prefetch" href="/assets/js/56.a4650fff.js"><link rel="prefetch" href="/assets/js/57.d7c232f0.js"><link rel="prefetch" href="/assets/js/58.096f9fa3.js"><link rel="prefetch" href="/assets/js/59.5864f60e.js"><link rel="prefetch" href="/assets/js/60.ecdd4216.js"><link rel="prefetch" href="/assets/js/61.d4ad6ede.js"><link rel="prefetch" href="/assets/js/62.8a591cc6.js"><link rel="prefetch" href="/assets/js/63.e673257d.js"><link rel="prefetch" href="/assets/js/64.071b31f4.js"><link rel="prefetch" href="/assets/js/65.c0b292cf.js"><link rel="prefetch" href="/assets/js/66.024e5cc3.js"><link rel="prefetch" href="/assets/js/67.e9aa69ce.js"><link rel="prefetch" href="/assets/js/68.bdba541e.js"><link rel="prefetch" href="/assets/js/69.6584add5.js"><link rel="prefetch" href="/assets/js/70.bfa2c9e2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.912ec5d4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">DMIT-2018 Student Notes</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/topics/" class="nav-link">Notes</a></div><div class="nav-item"><a href="/demos/eRestaurant/" class="nav-link router-link-active">Demos</a></div><div class="nav-item"><a href="/about/slides-installing-sql-server.html" class="nav-link">MS SQL 2017</a></div><div class="nav-item"><a href="/exercises/" class="nav-link">Take Home</a></div><div class="nav-item"><a href="https://github.com/DMIT-2018/StudentNotes/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Issues/Bugs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://moodle.nait.ca" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Moodle
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/topics/" class="nav-link">Notes</a></div><div class="nav-item"><a href="/demos/eRestaurant/" class="nav-link router-link-active">Demos</a></div><div class="nav-item"><a href="/about/slides-installing-sql-server.html" class="nav-link">MS SQL 2017</a></div><div class="nav-item"><a href="/exercises/" class="nav-link">Take Home</a></div><div class="nav-item"><a href="https://github.com/DMIT-2018/StudentNotes/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Issues/Bugs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://moodle.nait.ca" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Moodle
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/demos/eRestaurant/" class="sidebar-link">eRestaurant Demo</a></li><li><a href="/demos/eRestaurant/about/" class="sidebar-link">eRestaurant Background Story</a></li><li><a href="/demos/eRestaurant/dvcs/demo.html" class="sidebar-link">DVCS Demo</a></li><li><a href="/demos/eRestaurant/sitemaps/demo2.html" class="sidebar-link">Adding a Web.sitemap</a></li><li><a href="/demos/eRestaurant/linq/" class="sidebar-link">LINQ - Query and Method Syntax</a></li><li><a href="/demos/eRestaurant/linq/extensions.html" class="sidebar-link">LINQ - More Method Syntax</a></li><li><a href="/demos/eRestaurant/linq/practice.html" class="sidebar-link">Practice Linq</a></li><li><a href="/demos/eRestaurant/entityFramework/demo/demo.html" class="sidebar-link">Entity Framework Demo</a></li><li><a href="/demos/eRestaurant/entityFramework/practice/practice.html" class="sidebar-link">eRestuarant Practice</a></li><li><a href="/demos/eRestaurant/entityFramework/practice/practice-solution.html" class="sidebar-link">eRestuarant Practice - Solution</a></li><li><a href="/demos/eRestaurant/aspNet/frontDesk/adminController.html" class="sidebar-link">Special Events - BLL</a></li><li><a href="/demos/eRestaurant/aspNet/frontDesk/adminSpecialEvents.html" class="sidebar-link">Special Events - PL</a></li><li><a href="/demos/eRestaurant/aspNet/frontDesk/menu.html" class="sidebar-link">Occupied Tables</a></li><li><a href="/demos/eRestaurant/reports/reportViewer/" class="sidebar-link">eRestaurant - Reporting Basics</a></li><li><a href="/demos/eRestaurant/reports/customizing/" class="sidebar-link">Customizing your Report</a></li><li><a href="/demos/eRestaurant/aspNet/userControls/messageUserControl.html" class="active sidebar-link">MessageUserControl</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/demos/eRestaurant/aspNet/userControls/messageUserControl.html#the-general-approach" class="sidebar-link">The General Approach</a></li><li class="sidebar-sub-header"><a href="/demos/eRestaurant/aspNet/userControls/messageUserControl.html#creating-a-user-control" class="sidebar-link">Creating a User Control</a></li><li class="sidebar-sub-header"><a href="/demos/eRestaurant/aspNet/userControls/messageUserControl.html#writing-the-code-behind-of-the-user-control" class="sidebar-link">Writing the Code-Behind of the User Control</a></li><li class="sidebar-sub-header"><a href="/demos/eRestaurant/aspNet/userControls/messageUserControl.html#embedding-the-user-control-on-your-form" class="sidebar-link">Embedding the User Control on Your Form</a></li><li class="sidebar-sub-header"><a href="/demos/eRestaurant/aspNet/userControls/messageUserControl.html#using-the-message-usercontrol-from-your-bll-classes" class="sidebar-link">Using the Message UserControl from your BLL classes</a></li></ul></li><li><a href="/demos/eRestaurant/testing/manual.html" class="sidebar-link">Faking a Point In Time</a></li><li><a href="/demos/eRestaurant/linq/frontDesk/reservations.html" class="sidebar-link">LinqPad - Querying Reservations</a></li><li><a href="/demos/eRestaurant/aspNet/frontDesk/reservations.html" class="sidebar-link">Displaying Reservations</a></li><li><a href="/demos/eRestaurant/linq/frontDesk/occupiedTables.html" class="sidebar-link">LinqPad - Querying Occupied Tables</a></li><li><a href="/demos/eRestaurant/aspNet/frontDesk/occupiedTables.html" class="sidebar-link">Occupied Tables</a></li><li><a href="/demos/eRestaurant/aspNet/frontDesk/bootstrapStyle.html" class="sidebar-link">Styling the Front Desk</a></li><li><a href="/demos/eRestaurant/businessRules/businessRuleException.html" class="sidebar-link">Business Rule Violations</a></li><li><a href="/demos/eRestaurant/businessRules/frontDesk/seatingWalkIns.html" class="sidebar-link">Seating Walk-Ins</a></li><li><a href="/demos/eRestaurant/businessRules/frontDesk/seatingReservations.html" class="sidebar-link">Seating Reservations</a></li><li><a href="/demos/eRestaurant/aspNet/userControls/fakeDateTime.html" class="sidebar-link">Fake DateTime</a></li><li><a href="/demos/eRestaurant/aspNet/frontDesk/queryString.html" class="sidebar-link">Serving Tables</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="handling-exceptions-and-user-feedback-in-your-asp-net-pages"><a href="#handling-exceptions-and-user-feedback-in-your-asp-net-pages" aria-hidden="true" class="header-anchor">#</a> Handling Exceptions and User Feedback in your ASP.Net Pages</h1> <p>This article will walk you through the steps to create a re-usable User Control to give feedback to users about errors and successes while working with your forms. The styling and structure of the user control persented here leverages various features of Bootstrap. The general storyline of these code samples follows the eRestaurant web site, but can be easily adapted for similar environments and scenarios.</p> <h2 id="the-general-approach"><a href="#the-general-approach" aria-hidden="true" class="header-anchor">#</a> The General Approach</h2> <p>At the heart of the idea behind this approach is the commonality of needing to process user requests within the context of try/catch blocks. What is needed is a way to separate the unique processing activities of the various buttons and forms from the common (and repetitive) try/catch aspect of error handling. This approach will employ a UserControl.</p> <p>The concept of a User Control is to create an &quot;item&quot; using the asp.net web controls as it's building blocks. User Controls are built with the idea that they are reusable. A user control can replace the need of the developer to repeatedly code some common web page functionality over and over again. Once the control is create with any necessary code behind, it can be used on any web page.</p> <p>This user control will use a delegate as a callback for the unique processing for dealing with the try/catch aspect of error handling. This delegate can be passed to a central function on the user control and invoked as-needed within the try/catch block. The user control can then focus entirely on the presentation of feedback to the user on actions that the user wants to perform. The delegate will be include in the code-behind of the user control. Note that it is not part of the user control but rather include in the namespace containing the user control.</p> <h2 id="creating-a-user-control"><a href="#creating-a-user-control" aria-hidden="true" class="header-anchor">#</a> Creating a User Control</h2> <p>Create a folder on the root of your website called UserControls. Right-click on the folder and add a new item - a User Control named MessageUserControl.ascx (note the file extension is .ascx, signifying a user control in C#). Edit the contents of the user control to match the following markup.</p> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;%@ Control Language=&quot;C#&quot; AutoEventWireup=&quot;true&quot; CodeBehind=&quot;MessageUserControl.ascx.cs&quot; Inherits=&quot;DMIT2018Common.UserControls.MessageUserControl&quot; %&gt;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">asp:</span>Panel</span> <span class="token attr-name">ID</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>MessagePanel<span class="token punctuation">&quot;</span></span> <span class="token attr-name">runat</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>server<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>panel-heading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">asp:</span>Label</span> <span class="token attr-name">ID</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>MessageTitleIcon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">runat</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>server<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">asp:</span>Label</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">asp:</span>Label</span> <span class="token attr-name">ID</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>MessageTitle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">runat</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>server<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>panel-body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">asp:</span>Label</span> <span class="token attr-name">ID</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>MessageLabel<span class="token punctuation">&quot;</span></span> <span class="token attr-name">runat</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>server<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">asp:</span>Repeater</span> <span class="token attr-name">ID</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>MessageDetailsRepeater<span class="token punctuation">&quot;</span></span> <span class="token attr-name">runat</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>server<span class="token punctuation">&quot;</span></span> <span class="token attr-name">EnableViewState</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>headertemplate</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>headertemplate</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footertemplate</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footertemplate</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>itemtemplate</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>&lt;%# Eval(&quot;Error&quot;) %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>itemtemplate</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">asp:</span>Repeater</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">asp:</span>Panel</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="writing-the-code-behind-of-the-user-control"><a href="#writing-the-code-behind-of-the-user-control" aria-hidden="true" class="header-anchor">#</a> Writing the Code-Behind of the User Control</h2> <p>A number of the methods in the code-behind are very simple. Take some time to examine the code to see how the methods &quot;flow&quot; from one to the other as a &quot;chain&quot; of processes with different starting points. You might want to consider drawing out the &quot;call hierarchy&quot; that exists between these methods.</p> <p>The user control has been placed in its own namespace. The delegate (above) is part of this namespace but not in the actual user control class.</p> <p>The code-behind of the user control consists of four regions:</p> <ul><li>A region for string constants (used as part of the standard user feedback text and styles).</li> <li>A region for event handlers on the control (in this case, just the <code>Page_Load()</code> event).</li> <li>A set of public methods that can be called by the code-behind of the form on which this user control is placed.</li> <li>A set of private methods that do the &quot;heavy lifting&quot; or detailed processing of error handling and user feedback.</li></ul> <p>In order to simplify the usage of this control, a number of the methods are overloaded, thus limiting the public API of the form to the following key methods.</p> <dl><dt>ShowInfo()</dt> <dd>Displays a message in the message panel.</dd> <dt>TryRun()</dt> <dd>Processes a request through a callback delegate within a try/catch block.</dd> <dt>HandleDataBoundException</dt> <dd>Checks for an exception from an ObjectDataSource event and handles it by showing the details of the exception.</dd></dl> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">using</span> System<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>Entity<span class="token punctuation">.</span>Validation<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Linq<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Reflection<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Web<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>UI<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>UI<span class="token punctuation">.</span>WebControls<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> DMIT2018Common<span class="token punctuation">.</span>UserControls
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">delegate</span> <span class="token keyword">void</span> <span class="token function">ProcessRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">partial</span> <span class="token keyword">class</span> <span class="token class-name">MessageUserControl</span> <span class="token punctuation">:</span> <span class="token class-name">System<span class="token punctuation">.</span>Web<span class="token punctuation">.</span>UI<span class="token punctuation">.</span>UserControl</span>
    <span class="token punctuation">{</span>
        <span class="token preprocessor property">#<span class="token directive keyword">region</span> String Constants</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">string</span> STR_TITLE_GeneralErrors <span class="token operator">=</span> <span class="token string">&quot;Processing Error&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">string</span> STR_TEXT_GeneralErrors <span class="token operator">=</span> <span class="token string">&quot;Unable to process your submission due to the following reason(s).&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">string</span> STR_TITLE_ValidationErrors <span class="token operator">=</span> <span class="token string">&quot;Validation Errors&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">string</span> STR_TEXT_ValidationErrors <span class="token operator">=</span> <span class="token string">&quot;Validation errors encountered with your submission.&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">string</span> STR_TITLE_UsageInstructions <span class="token operator">=</span> <span class="token string">&quot;Usage Instructions&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">string</span> STR_TITLE_ICON_warning <span class="token operator">=</span> <span class="token string">&quot;glyphicon glyphicon-warning-sign&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">string</span> STR_PANEL_danger <span class="token operator">=</span> <span class="token string">&quot;panel panel-danger&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">string</span> STR_TITLE_ICON_info <span class="token operator">=</span> <span class="token string">&quot;glyphicon glyphicon-info-sign&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">string</span> STR_PANEL_info <span class="token operator">=</span> <span class="token string">&quot;panel panel-info&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">string</span> STR_TITLE_ICON_success <span class="token operator">=</span> <span class="token string">&quot;glyphicon glyphicon-ok-sign&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">const</span> <span class="token keyword">string</span> STR_PANEL_success <span class="token operator">=</span> <span class="token string">&quot;panel panel-success&quot;</span><span class="token punctuation">;</span>
        <span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>
        <span class="token preprocessor property">#<span class="token directive keyword">region</span> Event Handlers</span>
        <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">Page_Load</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            MessagePanel<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>
        <span class="token preprocessor property">#<span class="token directive keyword">region</span> Public methods - show messages and process requests within try/catch</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Displays a message in the message panel with a general title of &quot;Usage Instructions&quot;</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;message&quot;&gt;Text to display as the message&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ShowInfo</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">ShowInfo</span><span class="token punctuation">(</span>STR_TITLE_UsageInstructions<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Displays a message and title in the message panel with a general &quot;info&quot; display</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;title&quot;&gt;Title for the panel&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;message&quot;&gt;Text to display as the message&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ShowInfo</span><span class="token punctuation">(</span><span class="token keyword">string</span> title<span class="token punctuation">,</span> <span class="token keyword">string</span> message<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">ShowInfo</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> title<span class="token punctuation">,</span> STR_TITLE_ICON_info<span class="token punctuation">,</span> STR_PANEL_info<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Processes a request through a callback delegate within a try/catch block. Distinguished Entity Framework exceptions from general exceptions.</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;callback&quot;&gt;A delegate method to call within the try block&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TryRun</span><span class="token punctuation">(</span><span class="token class-name">ProcessRequest</span> callback<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">TryCatch</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Processes a request through a callback delegate within a try/catch block. Distinguished Entity Framework exceptions from general exceptions.</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;callback&quot;&gt;A delegate method to call within the try block&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;title&quot;&gt;Title for the panel&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;successMessage&quot;&gt;Text to display as the message if the callback processes without an exception&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TryRun</span><span class="token punctuation">(</span><span class="token class-name">ProcessRequest</span> callback<span class="token punctuation">,</span> <span class="token keyword">string</span> title<span class="token punctuation">,</span> <span class="token keyword">string</span> successMessage<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">TryCatch</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token function">ShowInfo</span><span class="token punctuation">(</span>successMessage<span class="token punctuation">,</span> title<span class="token punctuation">,</span> STR_TITLE_ICON_success<span class="token punctuation">,</span> STR_PANEL_success<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Checks for an exception from an ObjectDataSource event and handles it by showing the details of the exception.</span>
        <span class="token comment">/// Checks for an exception raised by a BusinessRuleException object (TargetInvocatonException), the InnerException</span>
        <span class="token comment">/// in extracted and reassigned as the incoming exception otherwise the incoming remains as it was coming in.</span>
        <span class="token comment">/// After handling the exception, the handling flag for the exception is set to true (handled).</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;e&quot;&gt;An event argument with details on the exception, if any&lt;/param&gt;</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">HandleDataBoundException</span><span class="token punctuation">(</span><span class="token class-name">ObjectDataSourceStatusEventArgs</span> e<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">var</span> ex <span class="token operator">=</span> e<span class="token punctuation">.</span>Exception<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ex <span class="token keyword">is</span> TargetInvocationException<span class="token punctuation">)</span>
                ex <span class="token operator">=</span> ex<span class="token punctuation">.</span>InnerException<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ex <span class="token keyword">is</span> DbEntityValidationException<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">HandleException</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token class-name">Exception</span> <span class="token keyword">as</span> DbEntityValidationException<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>ExceptionHandled <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
             <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ex <span class="token keyword">is</span> BusinessRuleException<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">HandleException</span><span class="token punctuation">(</span>ex <span class="token keyword">as</span> BusinessRuleException<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>ExceptionHandled <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ex <span class="token keyword">is</span> Exception<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">HandleException</span><span class="token punctuation">(</span>ex <span class="token keyword">as</span> Exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
                e<span class="token punctuation">.</span>ExceptionHandled <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>
        <span class="token preprocessor property">#<span class="token directive keyword">region</span> Private methods - process details of messaging</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Processes a request through a callback delegate within a try/catch block. Distinguished Entity Framework exceptions from general exceptions.</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;callback&quot;&gt;A delegate method to call within the try block&lt;/param&gt;</span>
        <span class="token comment">/// &lt;returns&gt;True if the callback was successful (did not generate an exception); false otherwise&lt;/returns&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">bool</span> <span class="token function">TryCatch</span><span class="token punctuation">(</span><span class="token class-name">ProcessRequest</span> callback<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">try</span>
            <span class="token punctuation">{</span>
                <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BusinessRuleException</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">HandleException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">DbEntityValidationException</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">HandleException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token function">HandleException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Handles a BusinessRuleException by displaying the details and general error.</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;ex&quot;&gt;An exception object generated from Entity Framework&lt;/param&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">HandleException</span><span class="token punctuation">(</span><span class="token class-name">BusinessRuleException</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">var</span> details <span class="token operator">=</span> <span class="token keyword">from</span> detail <span class="token keyword">in</span> ex<span class="token punctuation">.</span><span class="token class-name">RuleDetails</span>
                          <span class="token keyword">select</span> <span class="token keyword">new</span>
                          <span class="token punctuation">{</span>
                              Error <span class="token operator">=</span> detail
                          <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token function">ShowExceptions</span><span class="token punctuation">(</span>details<span class="token punctuation">,</span> ex<span class="token punctuation">.</span>Message<span class="token punctuation">,</span> STR_TITLE_ValidationErrors<span class="token punctuation">,</span> STR_TITLE_ICON_warning<span class="token punctuation">,</span> STR_PANEL_danger<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Handles a DbEntityValidationException by getting the details of each validation error and showing it as a Validation Exception.</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;ex&quot;&gt;An exception object generated from Entity Framework&lt;/param&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">HandleException</span><span class="token punctuation">(</span><span class="token class-name">DbEntityValidationException</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">var</span> details <span class="token operator">=</span> <span class="token keyword">from</span> <span class="token class-name">DbValidationError</span> error <span class="token keyword">in</span> ex<span class="token punctuation">.</span>EntityValidationErrors<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token class-name">ValidationErrors</span>
                          <span class="token keyword">select</span> <span class="token keyword">new</span>
                          <span class="token punctuation">{</span>
                              Error <span class="token operator">=</span> error<span class="token punctuation">.</span>ErrorMessage
                          <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token function">ShowExceptions</span><span class="token punctuation">(</span>details<span class="token punctuation">,</span> STR_TEXT_ValidationErrors<span class="token punctuation">,</span> STR_TITLE_ValidationErrors<span class="token punctuation">,</span> STR_TITLE_ICON_warning<span class="token punctuation">,</span> STR_PANEL_danger<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Handles an Exception by getting the root of the error and showing it as a General Exception.</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;ex&quot;&gt;A general Exception object&lt;/param&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">HandleException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name">Exception</span> root <span class="token operator">=</span> ex<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>InnerException <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                root <span class="token operator">=</span> root<span class="token punctuation">.</span>InnerException<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token keyword">is</span> DbEntityValidationException<span class="token punctuation">)</span>
                <span class="token function">HandleException</span><span class="token punctuation">(</span>root <span class="token keyword">as</span> DbEntityValidationException<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">dynamic</span><span class="token punctuation">[</span><span class="token punctuation">]</span> details <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">dynamic</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Error <span class="token operator">=</span> root<span class="token punctuation">.</span>Message <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token function">ShowExceptions</span><span class="token punctuation">(</span>details<span class="token punctuation">,</span> STR_TEXT_GeneralErrors<span class="token punctuation">,</span> STR_TITLE_GeneralErrors<span class="token punctuation">,</span> STR_TITLE_ICON_warning<span class="token punctuation">,</span> STR_PANEL_danger<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Binds error details to the repeater and displays the message panel.</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;details&quot;&gt;Details of the exception or message&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;messageText&quot;&gt;Text to display as the message&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;messageTitle&quot;&gt;Title for the panel&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;titleIcon&quot;&gt;Icon to show in the panel title&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;panelClass&quot;&gt;CSS Class to apply to the panel&lt;/param&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ShowExceptions</span><span class="token punctuation">(</span><span class="token keyword">object</span> details<span class="token punctuation">,</span> <span class="token keyword">string</span> messageText<span class="token punctuation">,</span> <span class="token keyword">string</span> messageTitle<span class="token punctuation">,</span> <span class="token keyword">string</span> titleIcon<span class="token punctuation">,</span> <span class="token keyword">string</span> panelClass<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            MessageDetailsRepeater<span class="token punctuation">.</span>DataSource <span class="token operator">=</span> details<span class="token punctuation">;</span>
            MessageDetailsRepeater<span class="token punctuation">.</span><span class="token function">DataBind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">ShowInfo</span><span class="token punctuation">(</span>messageText<span class="token punctuation">,</span> messageTitle<span class="token punctuation">,</span> titleIcon<span class="token punctuation">,</span> panelClass<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">/// &lt;summary&gt;</span>
        <span class="token comment">/// Displays the message panel.</span>
        <span class="token comment">/// &lt;/summary&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;messageText&quot;&gt;Text to display as the message&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;messageTitle&quot;&gt;Title for the panel&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;titleIcon&quot;&gt;Icon to show in the panel title&lt;/param&gt;</span>
        <span class="token comment">/// &lt;param name=&quot;panelClass&quot;&gt;CSS Class to apply to the panel&lt;/param&gt;</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ShowInfo</span><span class="token punctuation">(</span><span class="token keyword">string</span> messageText<span class="token punctuation">,</span> <span class="token keyword">string</span> messageTitle<span class="token punctuation">,</span> <span class="token keyword">string</span> titleIcon<span class="token punctuation">,</span> <span class="token keyword">string</span> panelClass<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            MessageLabel<span class="token punctuation">.</span>Text <span class="token operator">=</span> messageText<span class="token punctuation">;</span>
            MessageTitle<span class="token punctuation">.</span>Text <span class="token operator">=</span> messageTitle<span class="token punctuation">;</span>
            MessageTitleIcon<span class="token punctuation">.</span>CssClass <span class="token operator">=</span> titleIcon<span class="token punctuation">;</span>
            MessagePanel<span class="token punctuation">.</span>CssClass <span class="token operator">=</span> panelClass<span class="token punctuation">;</span>
            MessagePanel<span class="token punctuation">.</span>Visible <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token preprocessor property">#<span class="token directive keyword">endregion</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="embedding-the-user-control-on-your-form"><a href="#embedding-the-user-control-on-your-form" aria-hidden="true" class="header-anchor">#</a> Embedding the User Control on Your Form</h2> <p>Leveraging the MessageUserControl on your form is easy. Simply drag &amp; drop the control onto your form, and Visual Studio will create the markup for the <code>&lt;%@ Register … %&gt;</code> directive and the user control itself. The following code-example shows an edited version of this markup where the <code>TagPrefix</code> has been changed from uc1 to my.</p> <div class="language-xml extra-class"><pre class="language-xml"><code>&lt;%@ Register Src=&quot;~/UserControls/MessageUserControl.ascx&quot; TagPrefix=&quot;my&quot; TagName=&quot;MessageUserControl&quot; %&gt;
...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">my:</span>MessageUserControl</span> <span class="token attr-name">runat</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>server<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ID</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>MessageUserControl<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>After the control has been placed on your form, you simply need to set up a method <strong>(a void method with no parameters)</strong> that matches the pattern for the <code>ProcessRequest</code> delegate, and then call that method from within your button click event, as seen in this following example of a button-click that performs a lookup. The .ShowInfo() method can be used to display a message to the screen. The .TryRun() method is using the delegate to execute the program method GetYourDataInfo().</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">AWebDropDownList_Click</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>AWebDropDownList<span class="token punctuation">.</span>SelectedIndex <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            MessageUserControl<span class="token punctuation">.</span><span class="token function">ShowInfo</span><span class="token punctuation">(</span><span class="token string">&quot;Please select a .......&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            MessageUserControl<span class="token punctuation">.</span><span class="token function">TryRun</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ProcessRequest<span class="token punctuation">)</span>GetYourDataInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GetYOurDataInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//this is where your method logic would go</span>
        <span class="token class-name">SomeController</span> sysmgr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SomeController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">YourData</span> dataInfo <span class="token operator">=</span> sysmgr<span class="token punctuation">.</span><span class="token function">Get_SomeData</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>AWebDropDownList<span class="token punctuation">.</span>SelectedValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        aField<span class="token punctuation">.</span>Text <span class="token operator">=</span> dataInfo<span class="token punctuation">.</span>SomeProperty<span class="token punctuation">;</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>An alternative way of coding the example is to include the method code within the TryRun(). You have the additional capability to assign a title and success message to the TryRun(). The above example could also have use the title and success message.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">AWebDropDownList_Click</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">EventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>AWebDropDownList<span class="token punctuation">.</span>SelectedIndex <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            MessageUserControl<span class="token punctuation">.</span><span class="token function">ShowInfo</span><span class="token punctuation">(</span><span class="token string">&quot;Please select a ........&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            MessageUserControl<span class="token punctuation">.</span><span class="token function">TryRun</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span>
                <span class="token punctuation">{</span>
                    <span class="token comment">//this is where your method logic would go</span>
                    <span class="token class-name">SomeController</span> sysmgr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SomeController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">YourData</span> dataInfo <span class="token operator">=</span> sysmgr<span class="token punctuation">.</span><span class="token function">Get_SomeData</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>AWebDropDownList<span class="token punctuation">.</span>SelectedValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    aField<span class="token punctuation">.</span>Text <span class="token operator">=</span> dataInfo<span class="token punctuation">.</span>SomeProperty<span class="token punctuation">;</span>
                    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">&quot;Success&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Data Found&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>To use this control with an ObjectDataSource control, simply ensure your ObjectDataSource control calls an event handler for the Inserted, Updated and Deleted events. Make sure you've dragged the MessageUserControl.ascx onto your form as well.</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">asp:</span>ObjectDataSource</span> <span class="token attr-name">runat</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>server<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ID</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>SpecialEventDataSource<span class="token punctuation">&quot;</span></span> <span class="token attr-name">DataObjectTypeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>eRestaurant.Entities.SpecialEvent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">DeleteMethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>DeleteSpecialEvent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">InsertMethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>AddSpecialEvent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">OldValuesParameterFormatString</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>original_{0}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">SelectMethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ListAllSpecialEvents<span class="token punctuation">&quot;</span></span> <span class="token attr-name">TypeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>eRestaurant.BLL.RestaurantAdminController<span class="token punctuation">&quot;</span></span> <span class="token attr-name">UpdateMethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UpdateSpecialEvent<span class="token punctuation">&quot;</span></span> <span class="token attr-name">OnDeleted</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>CheckForException<span class="token punctuation">&quot;</span></span> <span class="token attr-name">OnInserted</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>CheckForException<span class="token punctuation">&quot;</span></span> <span class="token attr-name">OnSelected</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>CheckForException<span class="token punctuation">&quot;</span></span> <span class="token attr-name">OnUpdated</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>CheckForException<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">asp:</span>ObjectDataSource</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Then, in your code-behind of your page, you can pass the <code>ObjectDataSourceStatusEventArgs</code> to the user control.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">CheckForException</span><span class="token punctuation">(</span><span class="token keyword">object</span> sender<span class="token punctuation">,</span> <span class="token class-name">ObjectDataSourceStatusEventArgs</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        MessageUserControl<span class="token punctuation">.</span><span class="token function">HandleDataBoundException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="using-the-message-usercontrol-from-your-bll-classes"><a href="#using-the-message-usercontrol-from-your-bll-classes" aria-hidden="true" class="header-anchor">#</a> Using the Message UserControl from your BLL classes</h2> <p>This user control can handle errors that arise in your BLL controller classes when doing logic validation. A class called the BusingessRuleException has been created to transport your list of errors along with a general message to the user control. This class can go anywhere in your application library, however, for ease of maintenance, place it at the root of your application library.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>        <span class="token keyword">using</span> System<span class="token punctuation">;</span>
        <span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>
        <span class="token keyword">using</span> System<span class="token punctuation">.</span>Linq<span class="token punctuation">;</span>
        <span class="token keyword">using</span> System<span class="token punctuation">.</span>Web<span class="token punctuation">;</span>

        <span class="token keyword">namespace</span> DMIT2018Common<span class="token punctuation">.</span>UserControls
        <span class="token punctuation">{</span>
            <span class="token punctuation">[</span><span class="token class-name">Serializable</span><span class="token punctuation">]</span>
            <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BusinessRuleException</span> <span class="token punctuation">:</span> <span class="token class-name">Exception</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">public</span> List<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token operator">&gt;</span> RuleDetails <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
                <span class="token keyword">public</span> <span class="token function">BusinessRuleException</span><span class="token punctuation">(</span><span class="token keyword">string</span> message<span class="token punctuation">,</span> List<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token operator">&gt;</span> reasons<span class="token punctuation">)</span>
                    <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>RuleDetails <span class="token operator">=</span> reasons<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre></div><p>To implement this class, a) create a List to hold the error message strings, b) any error message you wish to create can be added to the List and c) at some point throw the BusinessRuleException.</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SomeControllerMethod</span><span class="token punctuation">(</span><span class="token class-name">SomeClass</span> item<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">using</span><span class="token punctuation">(</span><span class="token keyword">var</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DALCLassContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name">List</span> reasons <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token punctuation">;</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> some code <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>SomeField<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                reasons<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;your custom error message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>SomeField<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token string">&quot;some value&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                reasons<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">&quot;your custom error message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> more code  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>reasons<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BusinessRuleException</span><span class="token punctuation">(</span><span class="token string">&quot;general error message&quot;</span><span class="token punctuation">,</span> reasons<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{</span>
                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> more code <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">7/4/2018, 4:01:50 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/demos/eRestaurant/reports/customizing/" class="prev">
          Customizing your Report
        </a></span> <span class="next"><a href="/demos/eRestaurant/testing/manual.html">
          Faking a Point In Time
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/52.b73eca62.js" defer></script><script src="/assets/js/app.e1abd37d.js" defer></script>
  </body>
</html>
