(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{243:function(t,s,a){t.exports=a.p+"assets/img/Command-Save-Order.f95844dd.png"},244:function(t,s,a){t.exports=a.p+"assets/img/Query-Open-Order.8d7011e0.png"},245:function(t,s,a){t.exports=a.p+"assets/img/Query-Selected-Company.b5eea4a1.png"},246:function(t,s,a){t.exports=a.p+"assets/img/Query-First-Visit.d613e3fb.png"},270:function(t,s,a){t.exports=a.p+"assets/img/Form-State-Edit-Order.47f6c12d.png"},448:function(t,s,a){t.exports=a.p+"assets/img/Northwind-CustomerSales-Save.c8a6d630.png"},449:function(t,s,a){t.exports=a.p+"assets/img/Edit-Order.e5c76994.png"},450:function(t,s,a){t.exports=a.p+"assets/img/Selected-Company.62e53b9f.png"},451:function(t,s,a){t.exports=a.p+"assets/img/First-Visit.b96b47f0.png"},550:function(t,s,a){"use strict";a.r(s);var n=a(24),e=Object(n.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"customer-orders"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#customer-orders","aria-hidden":"true"}},[t._v("#")]),t._v(" Customer Orders")]),t._v(" "),n("p",[t._v("The customers of Northwind Traders place their orders by phone or fax. Employees then enter the details of the order into the system via the "),n("strong",[t._v("Customer Order Form")]),t._v(" (from the "),n("em",[t._v("Sales")]),t._v(" menu item on the website).")]),t._v(" "),n("p",[t._v("The form allows employees to create new orders and view previous orders. Any order whose "),n("em",[t._v("Order Date")]),t._v(" has been set cannot be modified, because that order has been "),n("em",[t._v('"Placed"')]),t._v(".")]),t._v(" "),n("p",[t._v("An order without an Order Date can be modified. It may be an order that is "),n("em",[t._v('"In Progress"')]),t._v(" (saved, but not placed), or an entirely new order.")]),t._v(" "),n("p",[t._v("The screen mockups in the following sections describe the planned user experience (UX) in working with the form.")]),t._v(" "),n("hr"),t._v(" "),n("h2",{attrs:{id:"open-the-sales-page"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#open-the-sales-page","aria-hidden":"true"}},[t._v("#")]),t._v(" Open the Sales Page")]),t._v(" "),n("p",[t._v("The first visit to the Sales page simply displays a list of existing customers that the employee can select from to view the customer's order history or to create a new order for the customer.")]),t._v(" "),n("blockquote",[n("p",[n("img",{attrs:{src:a(451),alt:"Sales Page - First Visit"}})])]),t._v(" "),n("p",[t._v("For the drop-down, only the Company Name and Customer Id are required on the form, so a simple POCO class geared to the needs of a drop-down is needed.")]),t._v(" "),n("blockquote",[n("p",[n("img",{attrs:{src:a(246),alt:"Sales Page - Data Query for First Visit"}})])]),t._v(" "),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("KeyValueOption")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" Key "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" Text "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("Clicking on the [Select] button will trigger the next major view of this page: the Selected Customer.")]),t._v(" "),n("hr"),t._v(" "),n("h2",{attrs:{id:"selected-customer"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#selected-customer","aria-hidden":"true"}},[t._v("#")]),t._v(" Selected Customer")]),t._v(" "),n("p",[t._v('When a customer is selected, the general company information is displayed, along with the order history of the customer. Order history is divided into two sets - Orders that have been shipped, and orders that have not been shipped (i.e.: "Open" orders).')]),t._v(" "),n("blockquote",[n("p",[n("img",{attrs:{src:a(450),alt:"Customer Order History"}})])]),t._v(" "),n("p",[t._v("When querying the database for this information, it quickly becomes clear that POCOs/DTOs are the most appropriate way to send information to the form.")]),t._v(" "),n("blockquote",[n("p",[n("img",{attrs:{src:a(245),alt:"Customer Order History - Data Query"}})])]),t._v(" "),n("p",[t._v("General customer information can be represented by a simple POCO, and the data is retrieved via code-behind. Part of the reason for this is that the data must be un-packed manually in the code-behind, since it is a "),n("em",[t._v("single")]),t._v(" customer whose information is retrieved.")]),t._v(" "),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("CustomerSummary")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" CompanyName "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" ContactName "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" Phone "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" Fax "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("Likewise, each line of the order history details can also be represented by a simple POCO. In this case, however, the data can be retrieved either manually in code-behind or through an "),n("code",[t._v("<asp:ObjectDataSource>")]),t._v(" control.")]),t._v(" "),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("CustomerOrder")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("int")]),t._v(" OrderId "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" Employee "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" DateTime"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" OrderDate "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" DateTime"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" RequiredDate "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" DateTime"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" ShippedDate "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" Shipper "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("decimal")]),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" Freight "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("decimal")]),t._v(" OrderTotal "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("hr"),t._v(" "),n("h2",{attrs:{id:"edit-new-existing-order"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#edit-new-existing-order","aria-hidden":"true"}},[t._v("#")]),t._v(" Edit New/Existing Order")]),t._v(" "),n("p",[t._v("When editing a new or existing order, "),n("strong",[t._v("summary information")]),t._v(" on the order needs to be available (relevant dates, shipping info, order total) as well as "),n("strong",[t._v("detail information")]),t._v(" on the order items.")]),t._v(" "),n("blockquote",[n("p",[n("img",{attrs:{src:a(449),alt:"Edit Order View"}})])]),t._v(" "),n("p",[t._v("If the order is new or "),n("strong",[t._v("not placed")]),t._v(" (which means that there is no "),n("code",[t._v("OrderDate")]),t._v("), then the order can be edited and saved. Once an order is placed (i.e., the "),n("em",[t._v("Order Date")]),t._v(" is set), then the order cannot be edited. This makes the form helpful for viewing details of placed orders (shipped or not shipped) while protecting the data from being inadvertantly changed.")]),t._v(" "),n("hr"),t._v(" "),n("h2",{attrs:{id:"query-responsibility"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#query-responsibility","aria-hidden":"true"}},[t._v("#")]),t._v(" Query Responsibility")]),t._v(" "),n("p",[t._v("Loading the form with an order populates the summary and detail information. This information is obtained from a single call to the BLL, which retrieves a DTO constructed from parts of the entities. Drop-downs use the same general-purpose POCO as was used earlier when displaying customers.")]),t._v(" "),n("blockquote",[n("p",[n("img",{attrs:{src:a(244),alt:"Query Open Order",title:"Query Open Order"}})])]),t._v(" "),n("p",[t._v("The DTO/POCO used for populating the order summary/details uses the following classes.")]),t._v(" "),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("CustomerOrderWithDetails")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("CustomerOrder")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" IEnumerable"),n("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("CustomerOrderItem"),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" Details "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token generic-method"}},[n("span",{attrs:{class:"token function"}},[t._v("List")]),n("span",{attrs:{class:"token punctuation"}},[t._v("<")]),n("span",{attrs:{class:"token class-name"}},[t._v("CustomerOrderItem")]),n("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("CustomerOrderItem")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("ProductItem")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("int")]),t._v(" OrderId "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("short")]),t._v(" Quantity "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("float")]),t._v(" DiscountPercent "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("ProductItem")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("int")]),t._v(" ProductId "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" ProductName "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" QuantityPerUnit "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("decimal")]),t._v(" UnitPrice "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("short")]),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" InStockQuantity "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("You may notice that the "),n("code",[t._v("ProductItem")]),t._v(" is the base class for the "),n("code",[t._v("CustomerOrderItem")]),t._v(". This class inheritance was introduced because the "),n("code",[t._v("ProductItem")]),t._v(" information is needed in another code-behind query - the one used to add items to the order.")]),t._v(" "),n("hr"),t._v(" "),n("h2",{attrs:{id:"adding-removing-items"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#adding-removing-items","aria-hidden":"true"}},[t._v("#")]),t._v(" Adding/Removing Items")]),t._v(" "),n("p",[t._v("When editing the order, all changes are persisted on the form only, rather than making hits to the BLL/DAL on each minor change. The reason for this is that the edit form is functioning as a "),n("strong",[t._v("working document")]),t._v(" - changes are not persisted unless the user clicks the [Save] or [Place Order] buttons.")]),t._v(" "),n("blockquote",[n("p",[n("img",{attrs:{src:a(270),alt:"Add/Remove Items"}})])]),t._v(" "),n("p",[t._v("As such, this requires a good deal of code-behind processing on the form. For example, when the user selects a product to add to the order, the pricing information is queried from the database to fill in the suggested order price. But when the user clicks the [Add] button, all of this information is manually placed into the list view's data.")]),t._v(" "),n("p",[t._v("Processes like this can make use of additional queries to the database (as in the query for "),n("code",[t._v("ProductItem")]),t._v(" details), but no commands are issued to the BLL.")]),t._v(" "),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("ProductItem")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("int")]),t._v(" ProductId "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" ProductName "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" QuantityPerUnit "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("decimal")]),t._v(" UnitPrice "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("short")]),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" InStockQuantity "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("hr"),t._v(" "),n("h2",{attrs:{id:"command-responsibility"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#command-responsibility","aria-hidden":"true"}},[t._v("#")]),t._v(" Command Responsibility")]),t._v(" "),n("p",[t._v("Editing the order is done by adding and removing order items as well as selecting the shipper, setting the freight, and entering the date that the order is required. None of these editing actions perform an update on the database directly. Rather, the changes are simply preserved on the form itself through the form's code-behind.")]),t._v(" "),n("blockquote",[n("p",[n("img",{attrs:{src:a(270),alt:"Form State"}})])]),t._v(" "),n("p",[t._v("Once all the editing is done, the user can either "),n("strong",[t._v("Save")]),t._v(" or "),n("strong",[t._v("Place")]),t._v(" the order. Both of these actions are performed as distinct transactions, meaning that all the relevant data from the form is sent to the BLL through a DTO.")]),t._v(" "),n("blockquote",[n("p",[n("img",{attrs:{src:a(243),alt:"Save Order"}})])]),t._v(" "),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("EditOrderItem")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("int")]),t._v(" ProductId "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("decimal")]),t._v(" UnitPrice "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("short")]),t._v(" OrderQuantity "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("float")]),t._v(" DiscountPercent "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("EditCustomerOrder")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("int")]),t._v(" OrderId "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("string")]),t._v(" CustomerId "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("int")]),t._v(" EmployeeId "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" DateTime"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" OrderDate "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" DateTime"),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" RequiredDate "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("int")]),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" ShipperId "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("decimal")]),n("span",{attrs:{class:"token operator"}},[t._v("?")]),t._v(" FreightCharge "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" IEnumerable"),n("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("EditOrderItem"),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" OrderItems "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("get")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("set")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("hr"),t._v(" "),n("h2",{attrs:{id:"saving-customer-orders"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#saving-customer-orders","aria-hidden":"true"}},[t._v("#")]),t._v(" Saving Customer Orders")]),t._v(" "),n("p",[t._v("Saving a customer order is done to preserve changes to an order while keeping it open (i.e., not setting the "),n("code",[t._v("OrderDate")]),t._v("). The customer order to be saved may be a new order or an existing open order. Both of these are handled by a single public BLL method, which internally shunts the main work of saving to two alternate private methods. Each private method ensures that their specific tasks are performed as "),n("strong",[t._v("transactions")]),t._v(" that succeed or fail as a group. The following sequence diagram roughly illustrates the process.")]),t._v(" "),n("p",[n("img",{attrs:{src:a(448),alt:"Save Customer Order - Sequence Diagram"}})]),t._v(" "),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("Save")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token class-name"}},[t._v("EditCustomerOrder")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// Always ensure you have been given data to work with")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("null")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("ArgumentNullException")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v('"order"')]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v('"Cannot save order; order information was not supplied."')]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// Business validation rules")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HasValue"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Exception")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),n("span",{attrs:{class:"token string"}},[t._v('"An order date of {order.OrderDate.Value.ToLongDateString()} has been supplied. The order date should only be supplied when placing orders, not saving them."')]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// Decide whether to add new or update")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("//  NOTE: Notice that no db activity is occuring yet.")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderId "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token function"}},[t._v("AddPendingOrder")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        "),n("span",{attrs:{class:"token function"}},[t._v("UpdatePendingOrder")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("The "),n("code",[t._v("Save()")]),t._v(' method performs initial validation, ensuring that the order exists and that the order date is not set. In either case, the order is open (or "pending"), and the work of saving changes ir routed to two separate methods, each of which ensure that the order is '),n("strong",[t._v("processed as a "),n("em",[t._v("single")]),t._v(" transaction")]),t._v(".")]),t._v(" "),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("AddPendingOrder")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token class-name"}},[t._v("EditCustomerOrder")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" context "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("NorthwindContext")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" orderInProcess "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Orders"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Add")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Order")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// Make the orderInProcess match the customer order as given...")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// A) The general order information")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CustomerID "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CustomerId"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EmployeeID "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EmployeeId"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipVia "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipperId"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Freight "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FreightCharge"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// B) Add order details")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("foreach")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" item "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderItems"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// Add as a new item")]),t._v("\n            "),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" newItem "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("OrderDetail")]),t._v("\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                ProductID "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                Quantity "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderQuantity"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                UnitPrice "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UnitPrice"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                Discount "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DiscountPercent\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDetails"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Add")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newItem"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// C) Save the changes (one save, one transaction)")]),t._v("\n        context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("SaveChanges")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("UpdatePendingOrder")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token class-name"}},[t._v("EditCustomerOrder")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" context "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("NorthwindContext")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" orderInProcess "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Orders"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Find")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderId"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// Make the orderInProcess match the customer order as given...")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// A) The general order information")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CustomerID "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CustomerId"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EmployeeID "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EmployeeId"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipVia "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipperId"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Freight "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FreightCharge"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// B) Add/Update/Delete order details")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("//    Loop through the items as known in the database (to update/remove)")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("foreach")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" detail "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDetails"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" changes "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderItems"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("SingleOrDefault")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" x"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("changes "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("null")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Entry")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("State "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" EntityState"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Deleted"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// flag for deletion")]),t._v("\n            "),n("span",{attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Discount "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" changes"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DiscountPercent"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Quantity "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" changes"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderQuantity"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UnitPrice "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" changes"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UnitPrice"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Entry")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("State "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" EntityState"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Modified"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("//    Loop through the new items to add to the database")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("foreach")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" item "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderItems"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{attrs:{class:"token keyword"}},[t._v("bool")]),t._v(" notPresent "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("!")]),t._v("orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Order_Details"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Any")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" x"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notPresent"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{attrs:{class:"token comment"}},[t._v("// Add as a new item")]),t._v("\n                "),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" newItem "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Order_Detail")]),t._v("\n                "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    ProductID "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    Quantity "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderQuantity"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    UnitPrice "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UnitPrice"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    Discount "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DiscountPercent\n                "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Order_Details"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Add")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newItem"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// C) Save the changes (one save, one transaction)")]),t._v("\n        context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Entry")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("State "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" EntityState"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Modified"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("SaveChanges")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("hr"),t._v(" "),n("h2",{attrs:{id:"placing-customer-orders"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#placing-customer-orders","aria-hidden":"true"}},[t._v("#")]),t._v(" Placing Customer Orders")]),t._v(" "),n("p",[t._v("Placing customer orders is much like saving, except that the order date must be set.")]),t._v(" "),n("div",{staticClass:"language-csharp extra-class"},[n("pre",{pre:!0,attrs:{class:"language-csharp"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("PlaceOrder")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token class-name"}},[t._v("EditCustomerOrder")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// Always ensure you have been given data to work with")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("null")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("ArgumentNullException")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v('"order"')]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v('"Cannot place order; order information was not supplied."')]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// Business validation rules")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token operator"}},[t._v("!")]),t._v("order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RequiredDate"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HasValue"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Exception")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),n("span",{attrs:{class:"token string"}},[t._v('"A  required date for the order is required when placing orders."')]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token operator"}},[t._v("!")]),t._v("order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HasValue"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Exception")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),n("span",{attrs:{class:"token string"}},[t._v('"An order date is required when placing orders."')]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token operator"}},[t._v("!")]),t._v("order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipperId"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("HasValue"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Exception")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v('"A shipper must be identified before placing an order."')]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderItems"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Count")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Exception")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v('"An order must have at least one item before it can be placed."')]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// Begin processing the order")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("using")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" context "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("NorthwindContext")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// Prep for processing...")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" customer "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Customers"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Find")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CustomerId"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("customer "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("null")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Exception")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v('"Customer does not exist"')]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" orderInProcess "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Orders"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Find")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderId"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("orderInProcess "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("null")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            orderInProcess "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Orders"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Add")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Order")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n            context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Entry")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("State "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" EntityState"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Modified"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// Make the orderInProcess match the customer order as given...")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// A) The general order information")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CustomerID "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CustomerId"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EmployeeID "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EmployeeId"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDate"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RequiredDate "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RequiredDate"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipVia "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipperId"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Freight "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FreightCharge"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// B) Default the ship-to info to the customer's info")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipName "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" customer"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CompanyName"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipAddress "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" customer"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Address"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipCity "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" customer"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("City"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipRegion "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" customer"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Region"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ShipPostalCode "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" customer"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PostalCode"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// C) Add/Remove/Update order details")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("//var toRemove = new List<OrderDetail>();")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("foreach")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" detail "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDetails"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" changes "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderItems"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("SingleOrDefault")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" x"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("changes "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("null")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),n("span",{attrs:{class:"token comment"}},[t._v("//toRemove.Add(detail);")]),t._v("\n                context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Entry")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("State "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" EntityState"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Deleted"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("// flag for deletion")]),t._v("\n            "),n("span",{attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Discount "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" changes"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DiscountPercent"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Quantity "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" changes"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderQuantity"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UnitPrice "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" changes"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UnitPrice"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Entry")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("detail"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("State "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" EntityState"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Modified"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("foreach")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" item "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" order"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderItems"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token operator"}},[t._v("!")]),t._v("orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDetails"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Any")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" x"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductID "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),n("span",{attrs:{class:"token comment"}},[t._v("// Add as a new item")]),t._v("\n                "),n("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" newItem "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("OrderDetail")]),t._v("\n                "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    ProductID "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ProductId"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    Quantity "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderQuantity"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    UnitPrice "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UnitPrice"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    Discount "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DiscountPercent\n                "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                orderInProcess"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("OrderDetails"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("Add")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newItem"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// D) Save the changes (one save, one transaction)")]),t._v("\n        context"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("SaveChanges")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])},[],!1,null,null,null);s.default=e.exports}}]);